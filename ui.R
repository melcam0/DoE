
header<-dashboardHeader(title = "DoE",
                        tags$li(actionLink("openModal", label = "",
                                           icon = icon("address-card")),
                                class = "dropdown"))

sidebar<- dashboardSidebar(
  # HTML('<p><center><font color="#CBA727" size=5px> E.C.A.I.F. </font></center>'),
  # hr(color="#CBA727"),
    sidebarMenu(
                menuItem(text = "Independent variables",icon = shiny::icon("codepen"),
                         menuSubItem(text = "Factorial Design",tabName = "fatt_compl"),
                         menuSubItem(text = "Fractional Design",tabName = "frazion"),
                         menuSubItem(text = "Plackett-Burman",tabName = "pb"),
                         menuSubItem(text = "CCD",tabName = "ccd"),
                         menuSubItem(text = "D-optimal Design",tabName = "d_opt"),
                         menuSubItem(text = "Customized Design",tabName = "pp")),
                menuItem(text = "Mixture",icon = shiny::icon("fill-drip"),
                         menuSubItem(text = "Simplex Design",tabName = "m_simplex"),
                         menuSubItem(text = "D-optimal Design",tabName = "m_d_opt"),
                         menuSubItem(text = "Customized Design",tabName = "m_pp")),

                
                hr(),
                menuItem(text = "File",icon = icon("briefcase", lib = "font-awesome"),
                         menuSubItem(text = "Variables Coding",tabName = "cd_var"),
                         menuSubItem(text = "Pareto Front",tabName = "pareto"),
                         hr(),
                         # menuSubItem("Notes",tabName = "dispensa"),
                         # menuSubItem("Slides",tabName = "diapositive"),
                         # hr(),
                         menuSubItem(text = "Examples",tabName = "esempi"),
                         br(),
                         # tags$header(
                         #   em(  
                         #     a(href="https://dispensedoe.netlify.app/",  "   Dispense" ,target="_blank",style="white-space: pre-wrap")
                         #   )
                         # ),
                         br(),
                         actionButton("quit", "Quit",onclick = "setTimeout(function(){window.close();},200);",
                                      style='padding:4px; font-size:80%'),
                         HTML('<p><center><font color="cyan"><br> Version 6.10 </font></center>'))
                         
                        )
    
    
   # HTML('<br><br><br><br><br><br><br><br><br><br><br>')
   # ,
   # div(
   # tags$img(src = base64enc::dataURI(file = "logo.jpg", mime = "image/jpg"), height="50%", width="50%"),
   # style="text-align: center;")
   # ,
   # HTML('<p><center><font color="#CBA727" size=5px> <br> MASTER <br> E.C.A.I.F. </font></center>')
  )

body<-dashboardBody(
  tags$head(tags$link(rel = "stylesheet", type = "text/css", href = "custom.css")), 
  fluidRow(useShinyjs(),
           # Indipendenti --------------------------------------------------------------------
           tabItems(
             tabItem(tabName = "fatt_compl",
                     fluidPage(titlePanel(uiOutput("fatt_compl_titolo")),
                               tabsetPanel(type = "tabs",
                                           tabPanel("Design",
                                                    column(12,
                                                           br()),
                                                    column(4,
                                                           numericInput("fatt_compl_k",label="nÂ° factors",width = "25%",value = 2,min = 1),
                                                           h4('Design'),
                                                           tableOutput("fatt_compl_dis"),
                                                           downloadButton("fatt_compl_download")),
                                                    column(8,
                                                           plotOutput('fatt_compl_figura_dis')),
                                                    column(12,
                                                           hr(),
                                                           h4('Model'),
                                                           textOutput("fatt_compl_modello")),
                                                    column(12,
                                                           hr(),
                                                           h4('Dispersion Matrix'),
                                                           div(style = 'overflow-x: scroll;',tableOutput("fatt_compl_matrdisp"))
                                                    ),
                                                    column(12,br(),
                                                           h3('Leverage Plot')),
                                                    column(3,
                                                           uiOutput('fatt_compl_selvar')),
                                                    column(6,
                                                           uiOutput('fatt_compl_fixvar')),
                                                    column(12),
                                                    column(6,
                                                           plotOutput('fatt_compl_livellolev', width = "100%", height = "500px")
                                                    ),
                                                    column(6,
                                                           plotOutput('fatt_compl_suplev', width = "100%", height = "500px")),
                                                    column(6),
                                                    column(3,
                                                           br(),
                                                           div(style='font-size: 80%; width: 90%;',
                                                               uiOutput('fatt_compl_lv_z'))),
                                                    column(3,
                                                           br(),
                                                           div(style='font-size: 80%; width: 90%;',
                                                               uiOutput('fatt_compl_lv_x')))),
                                           tabPanel("Model",
                                                    column(4,
                                                           br(),
                                                           uiOutput('fatt_compl_risptext'),
                                                           textInput(inputId = "fatt_compl_risp",label = "",value = "")),
                                                    column(8,
                                                           plotOutput('fatt_compl_figura_risp')),
                                                    column(8,
                                                           h3("Regression coefficients"),
                                                           h4("Estimate"),
                                                           verbatimTextOutput('fatt_compl_coeff'),
                                                           uiOutput('fatt_compl_stimint_txt'),
                                                           verbatimTextOutput('fatt_compl_stimint')),
                                                    column(12,
                                                           hr(),
                                                           plotOutput('fatt_compl_grcoeff')),
                                                    column(12,
                                                           hr(),
                                                           h3("Daniel plot (qq-plot)"),
                                                           plotOutput('fatt_compl_grsigncoeff')),
                                                    column(12,
                                                           hr(),
                                                           h3("Normalized quadratic effects plot"),
                                                           plotOutput('fatt_compl_grPareto')),
                                                    column(12,
                                                           hr(),
                                                           h3("Response surface plots"),
                                                           uiOutput('fatt_compl_selvar_spazio')
                                                    ),
                                                    column(3,
                                                           uiOutput('fatt_compl_mod_selvar')),
                                                    column(6,
                                                           uiOutput("fatt_compl_mod_fixvar")),
                                                    column(12),
                                                    column(6,
                                                           plotOutput('fatt_compl_livellorisp', width = "100%", height = "500px"),
                                                           uiOutput("fatt_compl_livellorisp_col")),
                                                    column(6,
                                                           plotOutput('fatt_compl_suprisp', width = "100%", height = "500px")),
                                                    column(6),
                                                    column(3,
                                                           br(),
                                                           div(style='font-size: 80%; width: 90%;',
                                                               uiOutput('fatt_compl_rp_z'))),
                                                    column(3,
                                                           br(),
                                                           div(style='font-size: 80%; width: 90%;',
                                                               uiOutput('fatt_compl_rp_x'))),
                                                    column(12,hr()),
                                                    column(5,
                                                           textInput(inputId = "fatt_compl_prev",label = "Prediction point (coord.separated by space)",value = ""),
                                                           verbatimTextOutput('fatt_compl_prev_df'),
                                                           verbatimTextOutput('fatt_compl_intprev')),
                                                    column(2),
                                                    column(3,
                                                           textInput(inputId = "fatt_compl_misind",label = "Independent measures",value = ""),
                                                           verbatimTextOutput('fatt_compl_misind_media'),
                                                           verbatimTextOutput('fatt_compl_misind_sd'),
                                                           verbatimTextOutput('fatt_compl_misind_gdl')),
                                                    column(12,
                                                           hr(),
                                                           h3("Interaction plot"),
                                                           uiOutput('fatt_compl_grinter_selvar')),
                                                    column(12,
                                                           plotOutput('fatt_compl_grinter')
                                                    ))))),
             
             tabItem(tabName = "frazion",
                     fluidPage(titlePanel(uiOutput("frazion_titolo")),
                               tabsetPanel(type = "tabs",
                                           tabPanel("Design",
                                                    column(12,
                                                           br(),
                                                           imageOutput("logo"),
                                                           br()),
                                                    column(4,
                                                           numericInput("frazion_k",label="nÂ° factors",width = "25%",value = 3,min = 3),
                                                           numericInput("frazion_p",label="nÂ° generators",width = "25%",value = 1)),
                                                    
                                                    column(6,
                                                           hr(),hr(),
                                                           h5('Generators'),
                                                           verbatimTextOutput("frazion_generat")),
                                                    column(12),
                                                    column(4,
                                                           h4('Design'),
                                                           tableOutput("frazion_dis"),
                                                           downloadButton("frazion_download")),
                                                    column(12),
                                                    column(4,
                                                           hr(),
                                                           h4('Model'),
                                                           textOutput("frazion_modello")),
                                                    column(8,
                                                           h5("Confusions"),
                                                           verbatimTextOutput("frazion_confusioni")),
                                                    column(12,
                                                           hr(),
                                                           h4('Dispersion Matrix'),
                                                           div(style = 'overflow-x: scroll',tableOutput("frazion_matrdisp"))),
                                                    column(12,br(),
                                                           h3('Leverage Plot')),
                                                    column(3,
                                                           uiOutput('frazion_selvar')),
                                                    column(6,
                                                           uiOutput('frazion_fixvar')),
                                                    column(12),
                                                    column(6,
                                                           plotOutput('frazion_livellolev', width = "100%", height = "500px")),
                                                    column(6,
                                                           plotOutput('frazion_suplev', width = "100%", height = "500px")),
                                                    column(6),
                                                    column(3,
                                                           br(),
                                                           div(style='font-size: 80%; width: 90%;',
                                                               uiOutput('frazion_lv_z'))),
                                                    column(3,
                                                           br(),
                                                           div(style='font-size: 80%; width: 90%;',
                                                               uiOutput('frazion_lv_x')))),
                                           
                                           tabPanel("Model",
                                                    column(4,
                                                           br(),
                                                           uiOutput('frazion_risptext'),
                                                           textInput(inputId = "frazion_risp",label = "",value = "")),
                                                    column(8,
                                                           plotOutput('frazion_figura_risp')),
                                                    column(8,
                                                           h3("Regression coefficients"),
                                                           h4("Estimate"),
                                                           verbatimTextOutput('frazion_coeff'),
                                                           uiOutput('frazion_stimint_txt'),
                                                           verbatimTextOutput('frazion_stimint')),
                                                    column(12,
                                                           hr(),
                                                           plotOutput('frazion_grcoeff')),
                                                    column(12,
                                                           hr(),
                                                           h3("Daniel plot (qq-plot)"),
                                                           plotOutput('frazion_grsigncoeff')),
                                                    column(12,
                                                           hr(),
                                                           h3("Normalized quadratic effects plot"),
                                                           plotOutput('frazion_grPareto')),
                                                    column(12,
                                                           hr(),
                                                           h3("Response surface plots"),
                                                           uiOutput('frazion_selvar_spazio')),
                                                    column(3,
                                                           uiOutput('frazion_mod_selvar')),
                                                    column(6,
                                                           uiOutput('frazion_mod_fixvar')),
                                                    column(12),
                                                    column(6,
                                                           plotOutput('frazion_livellorisp', width = "100%", height = "500px"),
                                                           uiOutput("frazion_livellorisp_col")),
                                                    column(6,
                                                           plotOutput('frazion_suprisp', width = "100%", height = "500px")),
                                                    column(6),
                                                    column(3,
                                                           br(),
                                                           div(style='font-size: 80%; width: 90%;',
                                                               uiOutput('frazion_rp_z'))),
                                                    column(3,
                                                           br(),
                                                           div(style='font-size: 80%; width: 90%;',
                                                               uiOutput('frazion_rp_x'))),
                                                    column(12,hr()),
                                                    column(5,
                                                           textInput(inputId = "frazion_prev",label = "Prediction point (coord.separated by space)",value = ""),
                                                           verbatimTextOutput('frazion_prev_df'),
                                                           verbatimTextOutput('frazion_intprev')),
                                                    column(2),
                                                    column(3,
                                                           textInput(inputId = "frazion_misind",label = "Independent measures",value = ""),
                                                           verbatimTextOutput('frazion_misind_media'),
                                                           verbatimTextOutput('frazion_misind_sd'),
                                                           verbatimTextOutput('frazion_misind_gdl')),
                                                    column(12,
                                                           hr(),
                                                           h3("Interaction plot"),
                                                           uiOutput('frazion_grinter_selvar')),
                                                    column(12,
                                                           plotOutput('frazion_grinter')
                                                    ))))),
             
             tabItem(tabName = "pb",
                     fluidPage(titlePanel(uiOutput("pb_titolo")),
                               tabsetPanel(type = "tabs",
                                           tabPanel("Design",
                                                    column(12,
                                                           br(),
                                                           br()),
                                                    column(4,
                                                           numericInput("pb_k",label="nÂ° factors",width = "25%",value = 5,min = 5),
                                                           uiOutput("pb_n")),
                                                    column(8,
                                                           uiOutput("dis16"),
                                                           span(uiOutput("pb_suggerimento"), style="color:red")),
                                                    column(12),
                                                    column(4,
                                                           h4('Design'),
                                                           tableOutput("pb_dis"),
                                                           downloadButton("pb_download")),
                                                    column(12),
                                                    column(4,
                                                           hr(),
                                                           h4('Model'),
                                                           textOutput("pb_modello")),
                                                    column(8,
                                                           h5("Confusions"),
                                                           verbatimTextOutput("pb_confusioni")),
                                                    column(12,
                                                           hr(),
                                                           h4('Dispersion Matrix'),
                                                           div(style = 'overflow-x: scroll',tableOutput("pb_matrdisp"))
                                                    )),
                                           
                                           tabPanel("Model",
                                                    column(4,
                                                           br(),
                                                           uiOutput('pb_risptext'),
                                                           textInput(inputId = "pb_risp",label = "",value = "")),
                                                    column(8,
                                                           plotOutput('pb_figura_risp')),
                                                    column(8,
                                                           h3("Regression coefficients"),
                                                           h4("Estimate"),
                                                           verbatimTextOutput('pb_coeff'),
                                                           uiOutput('pb_stimint_txt'),
                                                           verbatimTextOutput('pb_stimint')),
                                                    column(12,
                                                           hr(),
                                                           plotOutput('pb_grcoeff')),
                                                    column(12,
                                                           hr(),
                                                           h3("Daniel plot (qq-plot)"),
                                                           plotOutput('pb_grsigncoeff')),
                                                    column(12,
                                                           hr(),
                                                           h3("Normalized quadratic effects plot"),
                                                           plotOutput('pb_grPareto')),
                                                    column(12,
                                                           hr(),hr(),h3("Plot alias"),hr(),
                                                           plotOutput("pb_graf_alias")))))),
             
             tabItem(tabName = "ccd",
                     fluidPage(titlePanel(uiOutput("ccd_titolo")),
                               tabsetPanel(type = "tabs",
                                           tabPanel("Design",
                                                    column(12,
                                                           br()),
                                                    column(4,
                                                           numericInput("ccd_k",label="nÂ° factors",width = "25%",value = 2,min = 2),
                                                           numericInput("ccd_n",label="nÂ° center points",width = "25%",value = 1),
                                                           selectInput("ccd_alfa", label = "type:", 
                                                                       choices = list("rotable" = 1, "spherical" = 2, "face-centered" = 3, "orthogonal" = 4), 
                                                                       selected = 1,width="130px"),
                                                           # hr(),
                                                           h4('Design'),
                                                           tableOutput("ccd_dis"),
                                                           downloadButton("ccd_download")),
                                                    column(8,
                                                           plotOutput('ccd_figura_dis')),
                                                    column(12,
                                                           hr(),
                                                           h4('Model'),
                                                           textOutput("ccd_modello")),
                                                    column(12,
                                                           hr(),
                                                           h4('Dispersion Matrix'),
                                                           div(style = 'overflow-x: scroll',tableOutput("ccd_matrdisp"))),
                                                    column(12,br(),
                                                           h3('Leverage Plot')),
                                                    column(3,
                                                           uiOutput('ccd_selvar')),
                                                    column(6,
                                                           uiOutput('ccd_fixvar')),
                                                    column(12),
                                                    column(6,
                                                           plotOutput('ccd_livellolev', width = "100%", height = "500px")),
                                                    column(6,
                                                           plotOutput('ccd_suplev', width = "100%", height = "500px")),
                                                    column(6),
                                                    column(3,
                                                           br(),
                                                           div(style='font-size: 80%; width: 90%;',
                                                               uiOutput('ccd_lv_z'))),
                                                    column(3,
                                                           br(),
                                                           div(style='font-size: 80%; width: 90%;',
                                                               uiOutput('ccd_lv_x')))),
                                           
                                           tabPanel("Model",
                                                    column(4,
                                                           br(),
                                                           uiOutput('ccd_risptext'),
                                                           textInput(inputId = "ccd_risp",label = "",value = "")),
                                                    column(8,
                                                           plotOutput('ccd_figura_risp')),
                                                    column(8,
                                                           h3("Regression coefficients"),
                                                           h4("Estimate"),
                                                           verbatimTextOutput('ccd_coeff'),
                                                           uiOutput('ccd_stimint_txt'),
                                                           verbatimTextOutput('ccd_stimint')),
                                                    column(12,
                                                           hr(),
                                                           plotOutput('ccd_grcoeff')),
                                                    column(12,
                                                           hr(),
                                                           h3("Response surface plots"),
                                                           uiOutput('ccd_selvar_spazio')),
                                                    column(3,
                                                           uiOutput('ccd_mod_selvar')),
                                                    column(6,
                                                           uiOutput("ccd_mod_fixvar")),
                                                    column(12),
                                                    column(6,
                                                           plotOutput('ccd_livellorisp', width = "100%", height = "500px"),
                                                           uiOutput("ccd_livellorisp_col")),
                                                    column(6,
                                                           plotOutput('ccd_suprisp', width = "100%", height = "500px")),
                                                    column(6),
                                                    column(3,
                                                           br(),
                                                           div(style='font-size: 80%; width: 90%;',
                                                               uiOutput('ccd_rp_z'))),
                                                    column(3,
                                                           br(),
                                                           div(style='font-size: 80%; width: 90%;',
                                                               uiOutput('ccd_rp_x'))),
                                                    column(12,hr()),
                                                    column(5,
                                                           textInput(inputId = "ccd_prev",label = "Prediction point (coord.separated by space)",value = ""),
                                                           verbatimTextOutput('ccd_prev_df'),
                                                           verbatimTextOutput('ccd_intprev')),
                                                    column(2),
                                                    column(3,
                                                           textInput(inputId = "ccd_misind",label = "Independent measures",value = ""),
                                                           verbatimTextOutput('ccd_misind_media'),
                                                           verbatimTextOutput('ccd_misind_sd'),
                                                           verbatimTextOutput('ccd_misind_gdl')))))),
             
             tabItem(tabName = "d_opt",
                     fluidPage(titlePanel(uiOutput("d_opt_titolo")),
                               tags$head(
                                 tags$style(HTML(".shiny-output-error-validation {color: red;font-size: 130%; "))
                               ),
                               tabsetPanel(type = "tabs",
                                           tabPanel("Matrix of candidate points",
                                                    column(12,
                                                           br()),
                                                    column(4,
                                                           radioButtons("d_opt_pti_cand", label = "Matrix of candidate points:",
                                                                        choices = list("Built" = 1, "Upload" = 2), 
                                                                        selected = 1,inline = TRUE),
                                                           br(),
                                                           uiOutput('d_opt_costruisci')),
                                                    column(4,
                                                           uiOutput('d_opt_importa')),
                                                    column(4,
                                                           uiOutput('d_opt_importa_incolla_spazio'),
                                                           uiOutput('d_opt_importa_incolla'),
                                                           uiOutput('d_opt_importa_incolla_spazio1'),
                                                           uiOutput('d_opt_importa_excel_brws')),
                                                    column(12),
                                                    column(4,
                                                           uiOutput('d_opt_nvar')),
                                                    column(8,
                                                           htmlOutput("d_opt_lev_var1"),
                                                           htmlOutput("d_opt_lev_var2"),
                                                           htmlOutput("d_opt_lev_var3"),
                                                           htmlOutput("d_opt_lev_var4"),
                                                           htmlOutput("d_opt_lev_var5"),
                                                           htmlOutput("d_opt_lev_var6"),
                                                           htmlOutput("d_opt_lev_var7"),
                                                           htmlOutput("d_opt_lev_var8"),
                                                           htmlOutput("d_opt_lev_var9"),
                                                           htmlOutput("d_opt_lev_var10"),
                                                           htmlOutput("d_opt_lev_var11"),
                                                           htmlOutput("d_opt_lev_var12"),
                                                           htmlOutput("d_opt_lev_var13"),
                                                           htmlOutput("d_opt_lev_var14"),
                                                           htmlOutput("d_opt_lev_var15"),
                                                           htmlOutput("d_opt_lev_var16"),
                                                           htmlOutput("d_opt_lev_var17"),
                                                           htmlOutput("d_opt_lev_var18"),
                                                           htmlOutput("d_opt_lev_var19"),
                                                           htmlOutput("d_opt_lev_var20"),
                                                           htmlOutput("d_opt_lev_var21"),
                                                           htmlOutput("d_opt_lev_var22"),
                                                           htmlOutput("d_opt_lev_var23"),
                                                           htmlOutput("d_opt_lev_var24"),
                                                           htmlOutput("d_opt_lev_var25"),
                                                           htmlOutput("d_opt_lev_var26"),
                                                           htmlOutput("d_opt_lev_var27"),
                                                           htmlOutput("d_opt_lev_var28"),
                                                           htmlOutput("d_opt_lev_var29"),
                                                           htmlOutput("d_opt_lev_var30"),
                                                           htmlOutput("d_opt_lev_var31"),
                                                           htmlOutput("d_opt_lev_var32"),
                                                           htmlOutput("d_opt_lev_var33"),
                                                           htmlOutput("d_opt_lev_var34"),
                                                           htmlOutput("d_opt_lev_var35"),
                                                           htmlOutput("d_opt_lev_var36"),
                                                           htmlOutput("d_opt_lev_var37"),
                                                           htmlOutput("d_opt_lev_var38"),
                                                           htmlOutput("d_opt_lev_var39"),
                                                           htmlOutput("d_opt_lev_var40"),
                                                           htmlOutput("d_opt_lev_var41"),
                                                           htmlOutput("d_opt_lev_var42"),
                                                           htmlOutput("d_opt_lev_var43"),
                                                           htmlOutput("d_opt_lev_var44"),
                                                           htmlOutput("d_opt_lev_var45"),
                                                           htmlOutput("d_opt_lev_var46"),
                                                           htmlOutput("d_opt_lev_var47"),
                                                           htmlOutput("d_opt_lev_var48"),
                                                           htmlOutput("d_opt_lev_var49"),
                                                           htmlOutput("d_opt_lev_var50"),
                                                           uiOutput('d_opt_passo')),
                                                    column(12),
                                                    column(4,
                                                           uiOutput("d_opt_vincoli")),
                                                    column(5,
                                                           uiOutput("d_opt_vincoliinf_txt"),
                                                           uiOutput("d_opt_vincolisup_txt")),
                                                    column(12,
                                                           h4('Matrix of candidate points'),
                                                           radioButtons("d_opt_cp_ha", "Display",choices = c('Head' = 1,"All" =2),selected = 1,inline=TRUE),
                                                           div(style = 'overflow-x: scroll',tableOutput("d_opt_cp")),
                                                           downloadButton("d_opt_download"),
                                                           uiOutput('d_opt_cod')),
                                                    
                                                    
                                                    column(12,
                                                           uiOutput('d_opt_cp_cod_title'),
                                                           uiOutput('d_opt_cp_cod_ha'),
                                                           div(style = 'overflow-x: scroll',tableOutput("d_opt_cp_cod")),
                                                           
                                                           #downloadButton("d_opt_cp_cod_download")
                                                           shinyjs::hidden(downloadButton("d_opt_cp_cod_download"))
                                                           #uiOutput('d_opt_cp_cod_download')
                                                           
                                                    )
                                                    
            
                                           ),
                                           tabPanel('D-optimal Design',
                                                    column(12,
                                                           br()),
                                                    column(6,
                                                           checkboxGroupInput("d_opt_mod_tipo", label = 'Model with:',inline = TRUE,
                                                                              choices = list("Intercept" = 1,'Higher terms'=2),selected = c(1,2))),
                                                    column(6,
                                                           uiOutput("d_opt_mod_variabx")),
                                                    column(12,
                                                           hr(),
                                                           h4('Model'),
                                                           textOutput("d_opt_modello")),
                                                    column(12,
                                                           br()),
                                                    column(6,
                                                           htmlOutput('d_opt_Lnumexp'),
                                                           actionButton('d_opt_calc','Compute'),
                                                           hr()),
                                                    column(6,
                                                           htmlOutput('d_opt_Unumexp')),
                                                    column(12,
                                                           tableOutput('d_opt_table'),
                                                           tableOutput('d_opt_msg1'),
                                                           br()),
                                                    column(6,
                                                           plotOutput('d_opt_graf_D')),
                                                    column(6,
                                                           plotOutput('d_opt_graf_Vif')),
                                                    column(12,
                                                           br()),
                                                    column(8,
                                                           uiOutput('d_opt_numexp')),
                                                    column(12,
                                                           #uiOutput('d_opt_numexp'),
                                                           h4('D-optimal experimental matrix'),
                                                           div(style = 'overflow-x: scroll',tableOutput("d_opt_dis_opt")),
                                                           downloadButton("d_opt_dis_download"),
                                                           hr(),
                                                           h5('VIF'),
                                                           div(style = 'overflow-x: scroll',tableOutput("d_opt_vf")))
                                           ),
                                           tabPanel('D-optimal Design by addition',
                                                    column(12,
                                                           br()),
                                                    column(4,
                                                           radioButtons("d_opt_ag_importa", label = "Upload Design:",
                                                                        choices = list("Paste" = 1, "Excel" = 2), 
                                                                        selected = 1,inline = TRUE)),
                                                    column(4,
                                                           uiOutput('d_opt_ag_importa_incolla_spazio'),
                                                           uiOutput('d_opt_ag_importa_incolla'),
                                                           uiOutput('d_opt_ag_importa_incolla_spazio1'),
                                                           uiOutput('d_opt_ag_importa_excel_brws')),
                                                    column(12,
                                                           h4('Design already done'),
                                                           tableOutput("d_opt_dis_tbl")),
                                                    column(12,
                                                           br()),
                                                    column(6,
                                                           checkboxGroupInput("d_opt_ag_mod_tipo", label = 'Model with:',inline = TRUE,
                                                                              choices = list("Intercept" = 1,'Higher terms'=2),selected = c(1,2))),
                                                    column(6,
                                                           uiOutput("d_opt_ag_mod_variabx")),
                                                    column(12,
                                                           hr(),
                                                           h4('Model'),
                                                           textOutput("d_opt_ag_modello")),
                                                    column(12,
                                                           br()),
                                                    column(6,
                                                           htmlOutput('d_opt_ag_Lnumexp'),
                                                           actionButton('d_opt_ag_calc','Compute'),
                                                           hr()),
                                                    column(6,
                                                           htmlOutput('d_opt_ag_Unumexp')),
                                                    column(12,
                                                           tableOutput('d_opt_ag_table'),
                                                           tableOutput('d_opt_ag_msg1_tb'),
                                                           tableOutput('d_opt_ag_msg2_tb'),
                                                           tableOutput('d_opt_ag_msg3_tb'),
                                                           br()),
                                                    column(6,
                                                           plotOutput('d_opt_ag_graf_D')),
                                                    column(6,
                                                           plotOutput('d_opt_ag_graf_Vif')),
                                                    column(12,
                                                           br()),
                                                    column(8,
                                                           uiOutput('d_opt_ag_numexp')),
                                                    column(12,
                                                           # uiOutput('d_opt_ag_numexp'),
                                                           h4('D-optimal experimental matrix '),
                                                           h6(uiOutput('d_opt_ag_expes')),
                                                           div(style = 'overflow-x: scroll',tableOutput("d_opt_ag_dis_opt")),
                                                           downloadButton("d_opt_ag_dis_download"),
                                                           hr(),
                                                           h5('VIF'),
                                                           div(style = 'overflow-x: scroll',tableOutput("d_opt_ag_vf")))
                                           )
                               ))),
             tabItem(tabName = "pp",
                     fluidPage(titlePanel(uiOutput("pp_titolo")),
                               tags$head(
                                 tags$style(HTML(".shiny-output-error-validation {color: red;font-size:130%; "))),
                               tabsetPanel(type = "tabs",
                                           tabPanel("Design",
                                                    column(12,
                                                           br()),
                                                    column(4,
                                                           radioButtons("pp_importa", label = "Upload Design:",
                                                                        choices = list("Paste" = 1, "Excel" = 2), 
                                                                        selected = 1,inline = TRUE)),
                                                    column(4,
                                                           uiOutput('pp_importa_incolla_spazio'),
                                                           uiOutput('pp_importa_incolla'),
                                                           uiOutput('pp_importa_incolla_spazio1'),
                                                           uiOutput('pp_importa_excel_brws')),
                                                    column(12,
                                                           h4('Design'),
                                                           tableOutput("pp_dis")),
                                                    column(6,
                                                           checkboxGroupInput("pp_mod_tipo", label = 'Model with:',inline = TRUE,
                                                                              choices = list("Intercept" = 1,'Higher terms'=2),selected = c(1,2))),
                                                    column(6,
                                                           uiOutput("pp_mod_variabx"),
                                                           uiOutput('pp_inter')),
                                                    column(12,
                                                           hr(),
                                                           h4('Model'),
                                                           textOutput("pp_modello")),
                                                    column(12,
                                                           hr(),
                                                           h4('Dispersion Matrix'),
                                                           div(style = 'overflow-x: scroll',tableOutput("pp_matrdisp"))),
                                                    column(12,
                                                           hr(),
                                                           h5('VIF'),
                                                           div(style = 'overflow-x: scroll',tableOutput("pp_vf"))),
                                                    column(12,br(),
                                                           h3('Leverage Plot')),
                                                    #  column(5,
                                                    #         uiOutput('pp_selinteraz')),
                                                    column(3,
                                                           uiOutput('pp_selvar')),
                                                    column(6,
                                                           uiOutput('pp_fixvar')),
                                                    column(12),
                                                    column(6,
                                                           plotOutput('pp_livellolev', width = "100%", height = "500px")),
                                                    column(6,
                                                           plotOutput('pp_suplev', width = "100%", height = "500px")),
                                                    column(6,
                                                           br(),
                                                           checkboxInput("pp_vincoli", label = "Constraints", value = FALSE),
                                                           uiOutput("pp_vincoli_txt")),
                                                    column(3,
                                                           br(),
                                                           div(style='font-size: 80%; width: 90%;',
                                                               uiOutput('pp_lv_z'))),
                                                    column(3,
                                                           br(),
                                                           div(style='font-size: 80%; width: 90%;',
                                                               uiOutput('pp_lv_x')))
                                           ),
                                           tabPanel("Model",
                                                    column(4,
                                                           br(),
                                                           uiOutput('pp_risptext'),
                                                           textInput(inputId = "pp_risp",label = "",value = "")),
                                                    column(8,
                                                           plotOutput('pp_figura_risp')),
                                                    column(8,
                                                           h3("Regression coefficients"),
                                                           h4("Estimate"),
                                                           verbatimTextOutput('pp_coeff'),
                                                           uiOutput('pp_stimint_txt'),
                                                           verbatimTextOutput('pp_stimint')),
                                                    column(2),
                                                    column(2,
                                                           radioButtons("pp_resind", label = h3("Variance estimated by:"),
                                                                        choices = list("Residuals" = 1, "Independent measures" = 2), 
                                                                        selected = 1)),
                                                    column(12,
                                                           hr(),
                                                           plotOutput('pp_grcoeff')),
                                                    column(4,
                                                           hr(),
                                                           uiOutput('pp_R2_txt'),
                                                           verbatimTextOutput('pp_R2')),
                                                    column(12,
                                                           hr(),
                                                           h3("Daniel plot (qq-plot)"),
                                                           plotOutput('pp_grsigncoeff')),
                                                    column(12,
                                                           hr(),
                                                           h3("Normalized quadratic effects plot"),
                                                           plotOutput('pp_grPareto')),
                                                    column(12,
                                                           hr(),
                                                           h3("Response surface plots"),
                                                           uiOutput('pp_selvar_spazio')),
                                                    # column(5,
                                                    #        uiOutput('pp_mod_selinteraz')),
                                                    column(3,
                                                           uiOutput('pp_mod_selvar')),
                                                    column(6,
                                                           uiOutput("pp_mod_fixvar")),
                                                    column(12),
                                                    column(6,
                                                           plotOutput('pp_livellorisp', width = "100%", height = "500px"),
                                                           uiOutput("pp_livellorisp_col"),
                                                           # br(),
                                                           checkboxInput("pp_vincolirisp", label = "Constraints", value = FALSE),
                                                           uiOutput("pp_vincolirisp_txt")),
                                                    column(6,
                                                           plotOutput('pp_suprisp', width = "100%", height = "500px")),
                                                    column(6),
                                                    column(3,
                                                           br(),
                                                           div(style='font-size: 80%; width: 90%;',
                                                               uiOutput('pp_rp_z'))),
                                                    column(3,
                                                           br(),
                                                           div(style='font-size: 80%; width: 90%;',
                                                               uiOutput('pp_rp_x'))),
                                                    column(12,hr()),
                                                    column(5,
                                                           textInput(inputId = "pp_prev",label = "Prediction point (coord.separated by space)",value = ""),
                                                           verbatimTextOutput('pp_prev_df'),
                                                           verbatimTextOutput('pp_intprev')),
                                                    column(2),
                                                    column(3,
                                                           textInput(inputId = "pp_misind",label = "Independent measures",value = ""),
                                                           verbatimTextOutput('pp_misind_media'),
                                                           verbatimTextOutput('pp_misind_sd'),
                                                           verbatimTextOutput('pp_misind_gdl')),
                                                    column(12,br(),
                                                           h3('Semi-amplitude of the prediction confidence interval plot')),
                                                    column(3,
                                                           uiOutput('pp_selvar_icp')),
                                                    column(6,
                                                           uiOutput('pp_fixvar_icp')),
                                                    column(12),
                                                    column(6,
                                                           plotOutput('pp_livellolev_icp', width = "100%", height = "500px")),
                                                    column(6,
                                                           plotOutput('pp_suplev_icp', width = "100%", height = "500px")),
                                                    column(6,
                                                           br(),
                                                           checkboxInput("pp_vincoli_icp", label = "Constraints", value = FALSE),
                                                           uiOutput("pp_vincoli_txt_icp")),
                                                    column(3,
                                                           br(),
                                                           div(style='font-size: 80%; width: 90%;',
                                                               uiOutput('pp_lv_z_icp'))),
                                                    column(3,
                                                           br(),
                                                           div(style='font-size: 80%; width: 90%;',
                                                               uiOutput('pp_lv_x_icp'))),
                                                    column(12,
                                                           hr(),
                                                           h3("Interaction plot"),
                                                           uiOutput('pp_grinter_selvar')),
                                                    column(12,
                                                           plotOutput('pp_grinter')),
                                                    column(12,
                                                           hr(),
                                                           hr()),
                                                    column(6,
                                                           hr(),
                                                           h3("Residuals plot"),
                                                           plotOutput('pp_graf_res',brush = brushOpts(id="pp_graf_res_brush",resetOnNew = TRUE)),
                                                           hr(),
                                                           verbatimTextOutput('pp_graf_res_brush')),
                                                    column(6,
                                                           hr(),
                                                           h3("Fitted vs. experimental values plot"),
                                                           plotOutput('pp_graf_yfit',brush = brushOpts(id="pp_graf_yfit_brush",resetOnNew = TRUE)),
                                                           br(),
                                                           uiOutput('pp_midind_chk'),
                                                           hr(),
                                                           verbatimTextOutput('pp_graf_yfit_brush'))

                                           )
                               ))),
             
             
             
             
             
             
             # Miscele --------------------------------------------------------------------
             
             
             
             
             tabItem(tabName = "m_simplex",
                     fluidPage(titlePanel(uiOutput("m_simplex_titolo")),
                               tabsetPanel(type = "tabs",
                                           tabPanel("Design",
                                                    column(12,
                                                           br()),
                                                    column(4,
                                                           selectInput("m_simplex_mod",label="Model",width = "45%",
                                                                       choices = list('linear'=1,'quadratic'=2,'cubic'=3)),
                                                           h4('Design'),
                                                           tableOutput("m_simplex_dis"),
                                                           checkboxInput("m_simplex_axial", label = "axial points", value = FALSE),
                                                           downloadButton("m_simplex_download")),
                                                    column(8,
                                                           plotOutput('m_simplex_figura_dis')),
                                                    column(12,
                                                           br(),
                                                           br(),
                                                           br(),
                                                           br(),
                                                           br(),
                                                           br(),
                                                           h4('Model'),
                                                           textOutput("m_simplex_modello")),
                                                    column(3,
                                                           hr(),
                                                           h4('Dispersion Matrix'),
                                                           div(style = 'overflow-x: scroll;',tableOutput("m_simplex_matrdisp"))
                                                    ),
                                                    column(1),
                                                    column(8,br(),
                                                           h3('Leverage Plot'),
                                                           plotOutput('m_simplex_livellolev', width = "100%", height = "500px"))),
                                           
                                           tabPanel("Model",
                                                    column(4,
                                                           br(),
                                                           uiOutput('m_simplex_risptext'),
                                                           textInput(inputId = "m_simplex_risp",label = "",value = "")),
                                                    column(8,
                                                           plotOutput('m_simplex_figura_risp')),
                                                    column(8,
                                                           br(),
                                                           br(),
                                                           br(),
                                                           br(),
                                                           br(),
                                                           br(),
                                                           h3("Regression coefficients"),
                                                           h4("Estimate"),
                                                           verbatimTextOutput('m_simplex_coeff'),
                                                           uiOutput('m_simplex_stimint_txt'),
                                                           verbatimTextOutput('m_simplex_stimint')),
                                                    column(2),
                                                    column(2,
                                                           br(),
                                                           br(),
                                                           br(),
                                                           br(),
                                                           br(),
                                                           br(),
                                                           radioButtons("m_simplex_resind", label = h3("Variance estimated by:"),
                                                                        choices = list("Residuals" = 1, "Independent measures" = 2), 
                                                                        selected = 1)),
                                                    column(12,
                                                           hr(),
                                                           plotOutput('m_simplex_grcoeff')),
                                                    column(4,
                                                           br(),
                                                           br(),
                                                           br(),
                                                           br(),
                                                           br(),
                                                           br(),
                                                           br(),
                                                           br(),
                                                           br(),
                                                           br(),
                                                           br(),
                                                           br(),
                                                           br(),
                                                           br(),
                                                           br(),
                                                           br(),
                                                           br(),
                                                           br(),
                                                           br(),
                                                           br(),
                                                           br(),
                                                           br(),
                                                           br(),
                                                           uiOutput("m_simplex_livellorisp_col"),
                                                           checkboxInput("m_simplex_livellorisp_perc", label = "percentages", value = FALSE),
                                                           checkboxInput("m_simplex_livellorisp_reg", label = "regions", value = TRUE)),
                                                    column(8,
                                                           hr(),
                                                           h3("Response surface plots"),
                                                           br(),
                                                           plotOutput('m_simplex_livellorisp', width = "100%", height = "500px")),
                                                    column(12,
                                                           br(),
                                                           br(),
                                                           br(),
                                                           br(),
                                                           br()),
                                                    column(5,
                                                           textInput(inputId = "m_simplex_prev",label = "Prediction point (coord.separated by space)",value = ""),
                                                           verbatimTextOutput('m_simplex_prev_df'),
                                                           verbatimTextOutput('m_simplex_intprev')),
                                                    column(2),
                                                    column(3,
                                                           textInput(inputId = "m_simplex_misind",label = "Independent measures",value = ""),
                                                           verbatimTextOutput('m_simplex_misind_media'),
                                                           verbatimTextOutput('m_simplex_misind_sd'),
                                                           verbatimTextOutput('m_simplex_misind_gdl')))))),
             
             tabItem(tabName = "m_d_opt",
                     fluidPage(titlePanel(uiOutput("m_d_opt_titolo")),
                               tabsetPanel(type = "tabs",
                                           tabPanel("Matrix of candidate points",
                                                    column(12,
                                                           br()),
                                                    column(4,
                                                           radioButtons("m_d_opt_pti_cand", label = "Matrice punti candidati:",
                                                                        choices = list("Built" = 1, "Upload" = 2), 
                                                                        selected = 1,inline = TRUE)),
                                                    column(4,
                                                           uiOutput('m_d_opt_importa')),
                                                    column(4,
                                                           uiOutput('m_d_opt_importa_incolla_spazio'),
                                                           uiOutput('m_d_opt_importa_incolla'),
                                                           uiOutput('m_d_opt_importa_incolla_spazio1'),
                                                           uiOutput('m_d_opt_importa_excel_brws')),
                                                    column(12,
                                                           uiOutput('m_d_opt_vincoli_tle')),
                                                    column(5,
                                                           uiOutput("m_d_opt_vincoli"),
                                                           uiOutput("m_d_opt_vincoliinf_txt"),
                                                           uiOutput("m_d_opt_vincolisup_txt")),
                                                    column(3),
                                                    column(4,
                                                           uiOutput('m_d_opt_passo')),
                                                    column(12),
                                                    column(4,
                                                           h4('Matrix of candidate points'),
                                                           radioButtons("m_d_opt_cp_ha", "Display",choices = c('Head' = 1,"All" =2),selected = 1,inline=TRUE),
                                                           div(style = 'overflow-x: scroll',tableOutput("m_d_opt_cp")),
                                                           downloadButton("m_d_opt_download")),
                                                    column(8,
                                                           plotOutput('m_d_opt_figura_cp')),
                                                    column(12,
                                                           br(),
                                                           br(),
                                                           br(),
                                                           br(),
                                                           br(),
                                                           br(),
                                                           br(),
                                                           br())),
                                           
                                           tabPanel('D-optimal Design',
                                                    column(12,
                                                           br()),
                                                    column(6,
                                                           checkboxGroupInput("m_d_opt_mod_tipo", label = 'Model with:',inline = TRUE,
                                                                              choices = list("Quadratic terms" = 1,'Cubic term'=2),selected = c(1,2))),
                                                    column(6,
                                                           uiOutput("m_d_opt_mod_variabx")),
                                                    column(12,
                                                           hr(),
                                                           h4('Model'),
                                                           textOutput("m_d_opt_modello")),
                                                    column(12,
                                                           br()),
                                                    column(6,
                                                           htmlOutput('m_d_opt_Lnumexp'),
                                                           actionButton('m_d_opt_calc','Compute'),
                                                           hr()),
                                                    column(6,
                                                           htmlOutput('m_d_opt_Unumexp')),
                                                    column(12),
                                                    column(6,
                                                           tableOutput('m_d_opt_table'),
                                                           tableOutput('m_d_opt_msg1'),
                                                           br()),
                                                    column(6,
                                                           plotOutput('m_d_opt_graf_D')),
                                                    column(12,
                                                           br()),
                                                    column(8,
                                                           uiOutput('m_d_opt_numexp')),
                                                    column(12,
                                                           #uiOutput('m_d_opt_numexp'),
                                                           h4('D-optimal Design '),
                                                           div(style = 'overflow-x: scroll',tableOutput("m_d_opt_dis_opt")),
                                                           downloadButton("m_d_opt_dis_download"))),
                                           
                                           tabPanel('D-optimal Design by addition',
                                                    column(12,
                                                           br()),
                                                    column(4,
                                                           radioButtons("m_d_opt_ag_importa", label = "Upload Design:",
                                                                        choices = list("Paste" = 1, "Excel" = 2), 
                                                                        selected = 1,inline = TRUE)),
                                                    column(4,
                                                           uiOutput('m_d_opt_ag_importa_incolla_spazio'),
                                                           uiOutput('m_d_opt_ag_importa_incolla'),
                                                           uiOutput('m_d_opt_ag_importa_incolla_spazio1'),
                                                           uiOutput('m_d_opt_ag_importa_excel_brws')),
                                                    column(12,
                                                           h4('Design already done'),
                                                           tableOutput("m_d_opt_dis_tbl")),
                                                    column(12,
                                                           br()),
                                                    column(6,
                                                           checkboxGroupInput("m_d_opt_ag_mod_tipo", label = 'Model with:',inline = TRUE,
                                                                              choices = list("Quadratic terms" = 1,'Cubic term'=2),selected = c(1,2))),
                                                    column(6,
                                                           uiOutput("m_d_opt_ag_mod_variabx")),
                                                    column(12,
                                                           hr(),
                                                           h4('Model'),
                                                           textOutput("m_d_opt_ag_modello")),
                                                    column(12,
                                                           br()),
                                                    column(6,
                                                           htmlOutput('m_d_opt_ag_Lnumexp'),
                                                           actionButton('m_d_opt_ag_calc','Compute'),
                                                           hr()),
                                                    column(6,
                                                           htmlOutput('m_d_opt_ag_Unumexp')),
                                                    column(12),
                                                    column(6,
                                                           tableOutput('m_d_opt_ag_table'),
                                                           tableOutput('m_d_opt_ag_msg1_tb'),
                                                           tableOutput('m_d_opt_ag_msg2_tb'),
                                                           tableOutput('m_d_opt_ag_msg3_tb'),
                                                           br()),
                                                    column(6,
                                                           plotOutput('m_d_opt_ag_graf_D')),
                                                    column(12,
                                                           br()),
                                                    column(8,
                                                           uiOutput('m_d_opt_ag_numexp')),
                                                    column(12,
                                                           # uiOutput('m_d_opt_ag_numexp'),
                                                           h4('D-optimal experimental matrix '),
                                                           h6(uiOutput('m_d_opt_ag_expes')),
                                                           div(style = 'overflow-x: scroll',tableOutput("m_d_opt_ag_dis_opt")),
                                                           downloadButton("m_d_opt_ag_dis_download"))
                                           )
                               ))),
             
             tabItem(tabName = "m_pp",
                     fluidPage(titlePanel(uiOutput("m_pp_titolo")),
                               tags$head(
                                 tags$style(HTML(".shiny-output-error-validation {color: red;font-size: 130%; "))
                               ),
                               tabsetPanel(type = "tabs",
                                           tabPanel("Design",
                                                    column(12,
                                                           br()),
                                                    column(4,
                                                           radioButtons("m_pp_importa", label = "Upload Design:",
                                                                        choices = list("Paste" = 1, "Excel" = 2), 
                                                                        selected = 1,inline = TRUE)),
                                                    column(4,
                                                           uiOutput('m_pp_importa_incolla_spazio'),
                                                           uiOutput('m_pp_importa_incolla'),
                                                           uiOutput('m_pp_importa_incolla_spazio1'),
                                                           uiOutput('m_pp_importa_excel_brws')),
                                                    column(12),
                                                    column(4,
                                                           h4('Design'),
                                                           tableOutput("m_pp_dis")),
                                                    column(8,
                                                           plotOutput('m_pp_figura_dis')),
                                                    column(12,
                                                           br(),
                                                           br(),
                                                           br(),
                                                           br(),
                                                           br(),
                                                           br(),
                                                           br(),
                                                           br()),
                                                    column(6,
                                                           checkboxGroupInput("m_pp_mod_tipo", label = 'Model with:',inline = TRUE,
                                                                              choices = list("Quadratic terms" = 1,'Cubic term'=2),selected = c(1,2))),
                                                    column(6,
                                                           uiOutput("m_pp_mod_variabx")),
                                                    column(12,
                                                           hr(),
                                                           h4('Model'),
                                                           textOutput("m_pp_modello")),
                                                    column(3,
                                                           hr(),
                                                           h4('Dispersion Matrix'),
                                                           div(style = 'overflow-x: scroll',tableOutput("m_pp_matrdisp"))),
                                                    column(1),
                                                    column(8,br(),
                                                           h3('Leverage Plot'),
                                                           plotOutput('m_pp_livellolev', width = "100%", height = "500px")),
                                                    column(6,
                                                           br(),
                                                           checkboxInput("m_pp_vincoli", label = "Constraints", value = FALSE)),
                                                    column(12),
                                                    column(6,
                                                           uiOutput("m_pp_vincoliinf_txt")),
                                                    column(6,
                                                           uiOutput("m_pp_vincolisup_txt")),
                                                    column(12),
                                                    column(4),
                                                    column(8,
                                                           br(),
                                                           br(),
                                                           br(),
                                                           plotOutput('m_pp_livellolev_zoom', width = "100%", height = "500px"))
                                           ),
                                           tabPanel("Model",
                                                    column(4,
                                                           br(),
                                                           uiOutput('m_pp_risptext'),
                                                           textInput(inputId = "m_pp_risp",label = "",value = "")),
                                                    column(8,
                                                           plotOutput('m_pp_figura_risp')),
                                                    column(8,
                                                           br(),
                                                           br(),
                                                           br(),
                                                           br(),
                                                           br(),
                                                           br(),
                                                           h3("Regression coefficients"),
                                                           h4("Estimate"),
                                                           verbatimTextOutput('m_pp_coeff'),
                                                           uiOutput('m_pp_stimint_txt'),
                                                           verbatimTextOutput('m_pp_stimint')),
                                                    column(2),
                                                    column(2,
                                                           br(),
                                                           br(),
                                                           br(),
                                                           br(),
                                                           br(),
                                                           br(),
                                                           radioButtons("m_pp_resind", label = h3("Variance estimate by:"),
                                                                        choices = list("Residuals" = 1, "Independent measures" = 2), 
                                                                        selected = 1)),
                                                    column(12,
                                                           hr(),
                                                           plotOutput('m_pp_grcoeff')),
                                                    
                                                    column(4,
                                                           br(),
                                                           br(),
                                                           br(),
                                                           br(),
                                                           br(),
                                                           br(),
                                                           br(),
                                                           br(),
                                                           br(),
                                                           br(),
                                                           br(),
                                                           br(),
                                                           br(),
                                                           br(),
                                                           br(),
                                                           br(),
                                                           br(),
                                                           br(),
                                                           br(),
                                                           br(),
                                                           br(),
                                                           br(),
                                                           br(),
                                                           uiOutput("m_pp_livellorisp_col"),
                                                           checkboxInput("m_pp_livellorisp_perc", label = "percentages", value = FALSE),
                                                           checkboxInput("m_pp_livellorisp_reg", label = "regions", value = TRUE)),
                                                    column(8,
                                                           hr(),
                                                           h3("Response surface plots"),
                                                           hr(),
                                                           plotOutput('m_pp_livellorisp', width = "100%", height = "500px")),
                                                    
                                                    column(12,
                                                           br(),
                                                           br(),
                                                           br(),
                                                           br(),
                                                           br()),
                                                    column(5,
                                                           textInput(inputId = "m_pp_prev",label = "Prediction point (coord.separated by space)",value = ""),
                                                           verbatimTextOutput('m_pp_prev_df'),
                                                           verbatimTextOutput('m_pp_intprev')),
                                                    column(2),
                                                    column(3,
                                                           textInput(inputId = "m_pp_misind",label = "Independent measures",value = ""),
                                                           verbatimTextOutput('m_pp_misind_media'),
                                                           verbatimTextOutput('m_pp_misind_sd'),
                                                           verbatimTextOutput('m_pp_misind_gdl')),
                                                    column(12),
                                                    column(4),
                                                    column(8,
                                                           hr(),
                                                           uiOutput('m_pp_livellorisp_zoom_txt'),
                                                           hr(),
                                                           plotOutput('m_pp_livellorisp_zoom', width = "100%", height = "500px"))
                                           )))),
             
             # Codifica variabili --------------------------------------------------------------------  
             
             tabItem(tabName = "cd_var",
                     fluidPage(titlePanel(HTML('Variables coding')),
                               fluidPage(
                                 tabsetPanel(type = "tabs",
                                             tabPanel("Independent variables",
                                                      column(12,
                                                             br()),
                                                      column(4,
                                                             radioButtons("cd_var_importa", label = "Upload Design:",
                                                                          choices = list("Paste" = 1, "Excel" = 2), 
                                                                          selected = 1,inline = TRUE)),
                                                      column(4,
                                                             uiOutput('cd_var_importa_incolla_spazio'),
                                                             uiOutput('cd_var_importa_incolla'),
                                                             uiOutput('cd_var_importa_incolla_spazio1'),
                                                             uiOutput('cd_var_importa_excel_brws')),
                                                      column(12,
                                                             h4('Design'),
                                                             radioButtons("cd_var_dis_ha", "Display",choices = c('Head' = 1,"All" =2),selected = 1,inline=TRUE),
                                                             tableOutput("cd_var_dis")),
                                                      column(12,
                                                             hr(),
                                                             h4('Coded Design'),
                                                             radioButtons("cd_var_dis_cod_ha", "Display",choices = c('Head' = 1,"All" =2),selected = 1,inline=TRUE),
                                                             tableOutput("cd_var_dis_cod"),
                                                             downloadButton("cd_var_download"))
                                             ),
                                             tabPanel("Mixture",
                                                      
                                                      
                                                      
                                                      
                                                      
                                                      ))
                               )
                     )),
             
             
             # Pareto --------------------------------------------------------------------               
             tabItem(tabName = "pareto",
                     fluidPage(titlePanel(HTML('Pareto Front')),
                               fluidPage(                               
                                 column(12,
                                        br()),
                                 column(4,
                                        radioButtons("pareto_importa", label = "Upload prediction points matrix:",
                                                     choices = list("Paste" = 1, "Excel" = 2), 
                                                     selected = 1,inline = TRUE)),
                                 column(4,
                                        uiOutput('pareto_importa_incolla_spazio'),
                                        uiOutput('pareto_importa_incolla'),
                                        uiOutput('pareto_importa_incolla_spazio1'),
                                        uiOutput('pareto_importa_excel_brws')),
                                 column(12,
                                        h4('Create a Model in Custom Design and click on Prediction, after uploading prediction points matrix, for each new set of Responses entered!')),
                                 column(12),
                                 column(6,
                                        br(),
                                        actionButton("pareto_previsione", label = "Prediction"),
                                        actionButton("pareto_delete", label = "Delete"),
                                        h4('Prediction on uploaded data'),
                                        uiOutput('pareto_pred_ha'),
                                        verbatimTextOutput('pareto_pred'),
                                        downloadButton("pareto_pred_download")),
                                 column(12),
                                 column(6,
                                        uiOutput('pareto_radiobt')),
                                 column(6,
                                        uiOutput('pareto_target')),
                                 column(12),
                                 column(6,
                                        h4('Non dominated points'),
                                        verbatimTextOutput('pareto_dominati'),
                                        downloadButton("pareto_dominati_download")),
                                 
                                 column(12,
                                        h4('Non dominated points plot'),
                                        uiOutput('pareto_selvar')),
                                 column(8,
                                        plotOutput("pareto_graf",click = "pareto_graf_click",dblclick = "pareto_graf_dblclick",
                                                   brush = brushOpts(id="pareto_graf_brush",resetOnNew = TRUE))),
                                 column(2,
                                        checkboxInput("pareto_graf_labels", label = "Labels", value = FALSE)),
                                 column(12,
                                        br(),
                                        verbatimTextOutput("pareto_graf_selez"))
                                 ))),
             
                                             
             
             # File --------------------------------------------------------------------
             
             tabItem(tabName = "esempi",
                     fluidPage(titlePanel(HTML('Examples')),
                               column(8,
                                      uiOutput('lista_esempi')),
                               column(4,
                                      br(),
                                      actionButton("openxlsx", label = "Open xlsx")),
                               column(12,
                                      hr(),
                                      uiOutput("esempio")),
                               div(style = "height:1000px")
                               ))
 
             #tabItem(tabName = "dispensa",
                     #fluidPage(
                       #tabsetPanel(type = "tabs",
                                   #tabPanel("Glossario",
                                            #tags$iframe(style="height:600px; width:100%; scrolling=yes", 
                                                        #src="00_Glossario.pdf")),
                                   #tabPanel("Fattoriale completo",
                                            #tags$iframe(style="height:600px; width:100%; scrolling=yes", 
                                                        #src="01_Fattoriale_completo.pdf")),
                                   #tabPanel("Frazionario",
                                            #tags$iframe(style="height:600px; width:100%; scrolling=yes", 
                                                        #src="02_Disegni_frazionari.pdf")),
                                   #tabPanel("Plackett-Burmann",
                                            #tags$iframe(style="height:600px; width:100%; scrolling=yes", 
                                                        #src="03_Plackett_Burman.pdf")),
                                   #tabPanel("CCD",
                                            #tags$iframe(style="height:600px; width:100%; scrolling=yes", 
                                                        #src="04_CCD.pdf")),
                                   #tabPanel("D-ottimale",
                                            #tags$iframe(style="height:600px; width:100%; scrolling=yes", 
                                                        #src="05_D_ottimale.pdf")),
                                   #tabPanel("Miscele",
                                            #tags$iframe(style="height:600px; width:100%; scrolling=yes", 
                                                        #src="06_Miscele.pdf"))
                                   
                       #))),
             
             #tabItem(tabName = "diapositive",
                     #fluidPage(
                       #tabsetPanel(type = "tabs",
                                   #tabPanel("",
                                            #tags$iframe(style="height:600px; width:100%; scrolling=yes", 
                                                        #src="")),
                                   #tabPanel("",
                                            #tags$iframe(style="height:600px; width:100%; scrolling=yes", 
                                                        #src="")),
                                   #tabPanel("",
                                            #tags$iframe(style="height:600px; width:100%; scrolling=yes", 
                                                        #src="")),
                                   #tabPanel("",
                                            #tags$iframe(style="height:600px; width:100%; scrolling=yes", 
                                                        #src=""))
                                   
                                   
                       #)
          # )
           #)
             
             
             
             
             
             
           )
  ))






ui <- dashboardPage(skin="purple",header, sidebar, body,
                    tags$head(HTML("<title>DoE</title>"),
                              tags$link(rel = "stylesheet", type = "text/css", href = "tema.css"),
                              tags$link(rel = "shortcut icon", href = "doe.ico")))


